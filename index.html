<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Order Website</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#">Food Order</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link active" href="#home">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#products">Products</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#cart">Cart</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#order">Order</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#search">Search</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Slider -->
    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://img.freepik.com/premium-photo/different-fruits-vegetables-eating-healthy-ai-generative_21085-19801.jpg" class="d-block w-100" alt="Slide 1">
            </div>
            <div class="carousel-item">
                <img src="https://lh3.googleusercontent.com/hN3aO-2q2oT-xlxdKe0Y-jF1qLh_nYkXSShcuoBJ17KJMdg2t1qpWI3lQ-re11KPKajpvRrNpFrJUmSVAxa5WBQ=s800" class="d-block w-100" alt="Slide 2">
            </div>
            <div class="carousel-item">
                <img src="https://wildwoodhealth.com/wp-content/uploads/sites/2/2018/01/blog_fruits.jpg" class="d-block w-100" alt="Slide 3">
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>

    <!-- Food Insert Form -->
    <div class="container mt-5">
        <h2>Add Food Item</h2>
        <form id="foodForm" class="form-inline form-container">
            <div class="form-group">
                <label for="foodName" class="sr-only">Food Name</label>
                <input type="text" class="form-control" id="foodName" placeholder="Food Name" required>
            </div>
            <div class="form-group">
                <label for="foodPrice" class="sr-only">Price</label>
                <input type="number" class="form-control" id="foodPrice" placeholder="Price" required>
            </div>
            <div class="form-group">
                <label for="foodImage" class="sr-only">Image</label>
                <input type="file" class="form-control" id="foodImage" placeholder="Upload Image" required>
            </div>
            <button type="submit" class="btn btn-primary mb-2">Add Food</button>
        </form>
    </div>

    <!-- Product Table -->
    <table id="foodTable">
        <thead>
            <tr>
                <th>Sr No</th>
                <th>Product</th>
                <th>Price</th>
                <th>Image</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    <br>
    <br>
    <br><br>
    <!-- Footer -->
    <footer class="mt-5">
        <p>&copy; 2024 Food Order Website | Website design by Akash Jadhav</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script>
        document.getElementById('foodForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const foodName = document.getElementById('foodName').value;
            const foodPrice = document.getElementById('foodPrice').value;
            const foodImage = document.getElementById('foodImage').files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                addFoodItem(foodName, foodPrice, e.target.result);
                saveFoodItemToJson(foodName, foodPrice, e.target.result);
            }
            reader.readAsDataURL(foodImage);
        });

        function addFoodItem(name, price, image) {
            const table = document.getElementById('foodTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();
            const cell0 = newRow.insertCell(0);
            const cell1 = newRow.insertCell(1);
            const cell2 = newRow.insertCell(2);
            const cell3 = newRow.insertCell(3);
            const cell4 = newRow.insertCell(4);
            cell0.innerHTML = table.rows.length; // Set serial number dynamically
            cell1.innerHTML = name;
            cell2.innerHTML = `Rs.${price}`;
            cell3.innerHTML = `<img src="${image}" alt="${name}" width="50">`;
            cell4.innerHTML = '<button class="delete-button" onclick="confirmDelete(this)">Delete</button> <button class="edit-button" onclick="editRow(this)">Edit</button>';
            document.getElementById('foodForm').reset();
            Swal.fire({
                icon: 'success',
                title: 'Inserted Successfully',
                text: 'The food item has been added to the table.'
            });
        }

        function saveFoodItemToJson(name, price, image) {
            const foodItem = {
                name: name,
                price: price,
                image: image
            };
            fetch('save_food_item.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(foodItem)
            })
            .then(response => response.json())
            .then(data => {
                console.log('Success:', data);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
        }

        function confirmDelete(button) {
            Swal.fire({
                title: 'Are you sure?',
                text: "You won't be able to revert this!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes, delete it!'
            }).then((result) => {
                if (result.isConfirmed) {
                    hideRow(button);
                    Swal.fire(
                        'Deleted!',
                        'Your data has been deleted.',
                        'success'
                    )
                }
            })
        }

        function hideRow(button) {
            const row = button.parentNode.parentNode;
            row.style.display = 'none';
        }

        function editRow(button) {
            const row = button.parentNode.parentNode;
            const cells = row.getElementsByTagName('td');
            const foodName = cells[1].innerHTML;
            const foodPrice = cells[2].innerHTML.replace('Rs.', '');
            const foodImage = cells[3].getElementsByTagName('img')[0].src;
            document.getElementById('foodName').value = foodName;
            document.getElementById('foodPrice').value = foodPrice;
            document.getElementById('foodImage').value = '';
            row.style.display = 'none';
        }
    </script>
</body>
</html>